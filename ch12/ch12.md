# vue-router를 이용한 라우팅

동적 컴포넌트를 이용하면 어느 정도 여러 화면을 가진 애플리케이션을 만들 수는 있지만 특정 화면으로 직접 이동할 수 없고 반드시 `초기화면`을 거쳐야 한다. 이 문제는 `라우팅 기능`을 적용하여 애플리케이션을 개발해야 한다. 그래서 우리는 라우팅 기능을 알아보려 한다.

## vue-router란?

SPA라는 말을 들어봤는가? SPA는 **Single Page Application**의 약자이다. 단일 페이지 애플리케이션인데 최근 개발되는 웹애플리케이션은 모두 이 구조이다. 말 그대로 SPA는 하나의 페이지 안에서 데스크톱 애플리케이션과 같은 사용자 경험을 제공해 줄 수 있는 애플리케이션이다. SPA는 여러 화면을 하나의 페이지 안에서 제공하면서도 `화면을 별도로 로딩하지 않는다.` 그래서 화면마다 고유의 식별자를 기반으로 화면을 렌더링 해줘야 한다. 고유 식별자로 사용하기에 가장 적절한 정보가 바로 URI이다.

```
통합 자원 식별자(Uniform Resource Identifier, URI)는 인터넷에 있는 자원을 나타내는 유일한 주소이다.
URI의 존재는 인터넷에서 요구되는 기본조건으로서 인터넷 프로토콜에 항상 붙어 다닌다.
URI의 하위개념으로 URL, URN 이 있다.
```

Vue.js 애플리케이션에서 사용자가 요청한 URI 경로에 따라 다른 화면이 렌더링되도록 하려면 직접 코드로 구현해줄순 있지만 Vue.js에서는 대부분 잘 만들어진 라이브러리를 사용한다. 그것이 바로 vue-router이다.

### vue-router가 제공하는 기능

- 중첩된 경로, 뷰를 매핑할 수 있다.
- 컴포넌트 기반의 라우팅 구현 가능
- Vue.js의 전환 효과(Transition) 적용 가능
- 히스토리 모드와 해시 모드를 모두 사용 가능
- 쿼리스트링, 파라미터, 와일드 카드를 사용하여 라우팅 구현 가능

솔직히 나는 굳이 말하자면 첫번째, 두번째 빼고 나머지 기능은 아직 와닿지 않는다. <br>
어찌보면 다 와닿지 않는데 `굳이 말하자면...`

## vue-router 기초

vue-router의 기능을 테스트하기 위해 새 프로젝트를 생성해보자. Vue CLI도구의 `vue create` 명령어를 이용해 routertest 프로젝트를 생성한다. 기본 프리셋을 적용해서 생성하자.

다음으로 vue-router, bootstrap 패키지를 설치한다. 아래 예제에서는 bootstrap이 제공하는 css정보를 이용해 UI를 구성할것이다. 만약 오류가 난다면 `node_modules`디렉토리를 삭제하고 다시 `yarn add`나 `npm install` 명령어를 쳐서 전체 패키지를 다시 다운로드 하면 해결될 것이다.

```
vue create routertest
cd routertest

yarn add vue-router bootstrap@3.3.x
또는
npm install --save vue-router bootstrap@3.3.x
```

이제 VSCode를 실행하고 routertest 파일을 열어보겠다. 아래 예제는 앞서 배운 9장 4절에서 동적 컴포넌트를 배울 때 다루었던 예제를 vue-router를 사용하도록 변경해 볼 것이다.

우선 라우트로 보여 줄 컴포넌트를 정의해보자. `src/components` 디렉터리를 생성하고 9장 4절을 참고해서 `Home.vue / About.vue / Contacts.vue` 파일을 생성하고 다음과 같이 변경한다. <br>
**About.vue / Contacts.vue**는 예제에서 bold체로 표현된 부분만 변경해주자.

[ 예제 12-1 : src/components/Home.vue ]
```html
<template>
  <div>
      <h1>Home</h1>
  </div>
</template>
<script>
export default {
  name : "home"
}
</script>
```

이제 `src/App.vue` 파일을 수정해보자. 기존의 App.vue 파일의 내용을 모두 지우고 아래 코드를 넣어보자.

[ 예제 12-2 : src/components/App.vue ]
```javascript
<template>
<div>
  <div class="header">
    <h1 class="headerText">(주)OpenSG</h1>
    <nav>
      <ul>
        <li><router-link to="/home">Home</router-link></li>
        <li><router-link to="/about">About</router-link></li>
        <li><router-link to="/contacts">Contacts</router-link></li>
      </ul>
    </nav>
  </div>

  <div class="container">
    <router-view></router-view>
  </div>
</div>
</template>
<script>
import Home from './components/Home.vue';
import About from './components/About.vue';
import Contacts from './components/Contacts.vue';
import VueRouter from 'vue-router';
const router = new VueRouter({
  routes : [
    { path:'/', component: Home },
    { path:'/home', component: Home },
    { path:'/about', component: About },
    { path:'/contacts', component: Contacts }
  ]
})
export default {
  name : 'app',
  router
}
</script>
<style>
.header { background-color:aqua; padding: 10px 0px 0px 0px; }
.headerText { padding: 0px 20px 0px 20px; }
ul { list-style-type: none; margin: 0; padding: 0;
    overflow: hidden; background-color: purple;  }
li { float: left; }
li a { display: block; color: yellow; text-align: center;
    padding: 14px 16px; text-decoration: none;  }
li a:hover { background-color: aqua; color:black; }
</style>
```

이 `App.vue` 컴포넌트가 이 예제의 핵심이다.

```javascript
import VueRouter from 'vue-router';
```

이 import 구문을 이용해 vue-router를 참조해야 한다.

```javascript
const router = new VueRouter({
```
이 부분을 보면 각 경로별로 보여줄 컴포넌트를 매핑한 router 객체를 만들었다. 그 후 아래 부분과 같이 Vue 인스턴스를 만들 때 router 객체를 지정해준다.

```javascript
export default {
  name : 'app',
  router    // 이 부분
}
```

이제 `<template>` 부분을 살펴보겠다. 

```html
<div class="container">
  <router-view></router-view> <!-- 이 부분 -->
</div>
```
`<router-view>` 에는 URI 경로에 따라 router 객체에서 매핑한 컴포넌트가 이 위치에 나타난다. 
```html
<router-link></router-link> <!-- 이 부분은 메뉴로 이동할 수 있는 하이퍼링크를 생성한다 -->
```

마무리로 `main.js`를 수정해보겠다. import 구문을 이용해 vue-router를 참조하고 Vue.use() 메서드로 vue-router를 애플리케이션에서 사용할 수 있게 해보자.

[ 예제 12-3 : src/main.js ]
```javascript
import Vue from 'vue'
import App from './App.vue'
import 'bootstrap/dist/css/bootstrap.css'
import VueRouter from 'vue-router'

Vue.config.productionTip = false
Vue.use(VueRouter);

new Vue({
  render: h => h(App)
}).$mount('#app')
```

자! 이제 그럼 명령어를 쳐서 실행시켜보자.

```
yarn serve
```
실행 후 브라우저 개발자도구를 열고 `Vue devtools`를 확인해보면 헤더 메뉴를 클릭할 때마다 컴포넌트가 변경되는 것을 확인할 수 있다.

## 동적 라우트

동적 라우트 기능이란 일정한 패턴의 URI 경로를 `하나의 컴포넌트에 연결하는 방법이다`
예제를 통해서 확인해보자.

바로 앞전에 만든 **routertest** 프로젝트에서 새로운 기능을 추가해볼 것이다.

추가할 기능은 `/contacts` 경로로 요청했을 때 전체 연락처 명단을 나타내고, 명단을 클릭하면 `/contacts/{no}` 경로로 요청하여 연락처 상세 정보를 나타내보도록 하겠다.

샘플 데이터를 작성해보자. src 디렉터리 안에 ContactList.js 파일을 생성하고 다음과 같이 작성하자.

[ 예제 12-4 : src/ContactList.js ]
```javascript
var contactlist = {
  contacts : [
    { no:1001, name:'김유신', tel:'010-1212-3331', address:'경주' },
    { no:1002, name:'장보고', tel:'010-1212-3332', address:'청해진' },
    { no:1003, name:'관창', tel:'010-1212-3333', address:'황산벌' },
    { no:1004, name:'안중근', tel:'010-1212-3334', address:'해주' },
    { no:1005, name:'강감찬', tel:'010-1212-3335', address:'귀주' },
    { no:1006, name:'정몽주', tel:'010-1212-3336', address:'개성' },
    { no:1007, name:'이순신', tel:'010-1212-3337', address:'통제영' },
    { no:1008, name:'김시민', tel:'010-1212-3338', address:'진주' },
    { no:1009, name:'정약용', tel:'010-1212-3339', address:'남양주' }
  ]
}

export default contactlist;
```

다음은 기존 `Contacts.vue` 컴포넌트를 수정한다. 위의 예제 12-4의 객체를 데이터로 사용할 것이다.

[ 예제 12-5 : src/components/Contacts.vue 컴포넌트 변경 ]
```javascript
<template>
  <div>
    <h1>연락처</h1>
    <div class="wrapper">
        <div class="box" v-for="c in contacts" :key="c.no">
            <router-link v-bind:to="{ name:'contactbyno', params:{ no:c.no }}">
               {{c.name}}
            </router-link>
        </div>
    </div>
    <router-view></router-view>
  </div>
</template>
<script>
import contactlist from '../ContactList';
export default {
  name : "contacts",
  data : function() {
      return {
          contacts : contactlist.contacts
      }
  }
}
</script>
<style>
.wrapper{background-color:#fff; clear:both; display:table;}
.box{float:left; background-color:aqua; border-radius:5px; padding: 10px; margin:3px; text-align:center; font-size:120%; width:100px; font-weight:bold;}
a:link, a:visited{text-align:center; text-decoration:none; display:inline-block;}
</style>
```